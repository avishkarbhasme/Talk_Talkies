<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Genre</title>
    <link rel="shortcut icon" type="x-icon" href="/images/favicon.png">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Manufacturing+Consent&display=swap');

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: black;
            color: #444;
            font-family: Poppins, sans-serif;
            background-image: url('./images/bggen1.jpg');
            background-repeat: no-repeat;
            background-position: center center;
            background-size: cover;
            background-attachment: fixed;
            min-height: 100vh;
            overflow-x: hidden;
        }

        body::-webkit-scrollbar {
            display: none;
        }

        .nav {
            margin: 5px;
            background-color: rgba(0, 0, 0, 0.5);
            border-radius: 30px;
            color: white;
            padding: clamp(8px, 2vw, 10px) clamp(10px, 3vw, 20px);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: fixed;
            top: 0;
            left: 0;
            width: calc(100% - 10px);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
            z-index: 1000;
        }

        .navbar {
            height: 11vh;
        }

        .symbol {
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: "Manufacturing Consent", system-ui;
            font-weight: 400;
            font-style: normal;
            font-size: clamp(24px, 5vw, 40px);
            text-shadow: 0 0 3px #090909;
        }

        .symbol img {
            width: clamp(30px, 8vw, 60px);
            height: clamp(30px, 8vw, 60px);
        }

        .symname {
            color: rgb(227, 44, 44);
        }

        .containerr ul {
            list-style: none;
            display: flex;
            gap: clamp(10px, 2vw, 20px);
            margin: 0;
            padding: 0;
        }

        .item {
            height: auto;
            padding: 5px 10px;
            border: 1px solid transparent;
            transition: border-color 0.3s ease-in-out;
            cursor: pointer;
        }
        .genit{
            border-top-color: rgb(240, 255, 37);
            border-right-color: black;
            border-bottom-color: rgb(48, 241, 225);
            border-left-color: black;
        }


        .item:hover {
            border-top-color: rgb(240, 255, 37);
            border-right-color: black;
            border-bottom-color: rgb(48, 241, 225);
            border-left-color: black;
        }

        .item a {
            text-decoration: none;
            color: white;
            padding: 8px;
            display: block;
            font-size: clamp(14px, 2vw, 16px);
        }

        .login {
            display: flex;
            align-items: center;
        }

        .login img {
            width: clamp(20px, 4vw, 24px);
            height: clamp(20px, 4vw, 24px);
            margin-right: 5px;
        }

        .neonText:hover {
            color: #fff;
            text-shadow: 0 0 7px #fff, 0 0 10px #fff, 0 0 21px #fff,
                0 0 42px rgb(239, 12, 186), 0 0 82px rgb(239, 12, 186),
                0 0 92px rgb(239, 12, 186), 0 0 102px rgb(239, 12, 186),
                0 0 120px rgb(239, 12, 186);
        }

        .neon:hover {
            color: #fff;
            text-shadow: 0 0 7px #fff, 0 0 10px #fff, 0 0 21px #fff,
                0 0 42px rgb(227, 44, 44), 0 0 82px rgb(227, 44, 44),
                0 0 92px rgb(227, 44, 44), 0 0 102px rgb(227, 44, 44),
                0 0 120px rgb(227, 44, 44);
        }

        .hamburger {
            display: none;
            background: none;
            border: none;
            cursor: pointer;
            padding: 10px;
            z-index: 1100;
            position: relative;
        }

        .hamburger svg {
            width: clamp(24px, 6vw, 30px);
            height: clamp(24px, 6vw, 30px);
            fill: white;
        }

        .container {
            max-width: 92%;
            margin: clamp(20px, 5vw, 40px) auto;
            padding: 0 clamp(10px, 2vw, 20px);
        }

        .gencon {
            margin-top: clamp(80px, 15vw, 120px);
        }

        .tvgen {
            align-items: center;
            padding: 5px;
            display: flex;
            justify-content: center;
            color: rgb(254, 254, 254);
            gap: 15px;
            padding-bottom: clamp(20px, 4vw, 30px);
        }

        .tv {
            width: clamp(30px, 6vw, 50px);
            height: clamp(30px, 6vw, 50px);
        }

        .line2 {
            margin-top: clamp(20px, 4vw, 30px);
            border-bottom: 2px solid #f0de16;
        }

        .genre-section {
            margin-bottom: clamp(20px, 4vw, 30px);
        }

        .genre-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .genre-header h2 {
            margin: 0;
            color: yellow;
            text-decoration: underline;
            text-decoration-color: aqua;
            font-size: clamp(18px, 4vw, 24px);
        }

        .toggle-btn {
            font-size: clamp(12px, 2vw, 14px);
            background: #16f045;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            cursor: pointer;
        }

        .movie-row {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(clamp(180px, 25vw, 250px), 1fr));
            gap: clamp(10px, 2vw, 16px);
        }

        .movie-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            cursor: pointer;
        }

        .movie-placeholder {
            background: #ccc;
            height: clamp(120px, 20vw, 150px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: clamp(14px, 3vw, 16px);
        }

        .movie-content {
            padding: clamp(8px, 2vw, 12px);
        }

        .movie-title {
            font-size: clamp(16px, 3vw, 18px);
            font-weight: 600;
        }

        .movie-meta {
            font-size: clamp(12px, 2vw, 14px);
            margin: 0.3rem 0;
            display: -webkit-box;
            line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .stars {
            color: #facc15;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1200;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            padding: clamp(15px, 3vw, 20px);
            border-radius: 10px;
            max-width: clamp(300px, 90vw, 700px);
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 1.5rem;
            cursor: pointer;
            color: #fff;
            background: rgb(227, 44, 44);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
            z-index: 1300;
        }

        .modal-close:hover {
            background: rgb(239, 12, 186);
        }

        .modal-poster {
            background: #ccc;
            height: clamp(150px, 30vw, 250px);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: clamp(16px, 4vw, 20px);
            margin-bottom: 1rem;
        }

        @media (max-width: 768px) {
            .nav {
                padding: clamp(5px, 2vw, 8px) clamp(8px, 2vw, 12px);
            }

            .containerr {
                display: none;
                width: 100%;
                position: absolute;
                top: 100%;
                left: 0;
                background-color: rgba(0, 0, 0, 0.5);
                border-radius: 0 0 30px 30px;
                z-index: 1000;
            }

            .containerr.active {
                display: block;
            }

            .containerr ul {
                flex-direction: column;
                gap: 10px;
                padding: 10px;
            }

            .item {
                text-align: center;
            }

            .hamburger {
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .gencon {
                margin-top: clamp(70px, 12vw, 100px);
            }

            .movie-row {
                grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            }

            .genre-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
        }

        @media (max-width: 480px) {
            .movie-row {
                grid-template-columns: 1fr;
            }

            .movie-card {
                width: 100%;
            }

            .modal-content {
                padding: 10px;
            }

            .modal-poster {
                height: 120px;
            }
        }
    </style>
</head>
<body>
    <nav class="nav navbar">
        <div class="symbol">
            <a class="logo" href="/index.html">
                <img class="img" alt="Logo" src="/images/favicon.png" />
            </a>
            <a class="symname neon" href="/index.html">TalkTalkies</a>
        </div>
        <button class="hamburger" aria-label="Toggle menu">
            <svg width="30" height="30" viewBox="0 0 30 30" fill="white">
                <path d="M5 6h20v4H5zm0 7h20v4H5zm0 7h20v4H5z"/>
            </svg>
        </button>
        <div class="containerr">
            <ul>
                <li class="item neonText">
                    <a class="nav-link" href="/index.html">Home</a>
                </li>
                <li class="item neonText">
                    <a class="nav-link" href="/subpages/moviepage/index.html">Movies</a>
                </li>
                <li class="item dropdown neonText genit">
                    <a id="dropdown-link" href="/subpages/genrepage/index.html">Genre</a>
                </li>
                <li class="item neonText">
                    <a class="nav-link" href="/subpages/communitypage/com/frontend/index.html">Community</a>
                </li>
                <li class="item login neonText">
                    <a class="nav-link" href="/auth/index.html"><img src="/images/login.png" alt="login"></a>
                    <a class="nav-link" href="/auth/index.html">Login</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="gencon">
        <div class="line2">
            <h1 class="tvgen"><img class="tv" src="./images/tv.png" />Genre</h1>
        </div>
        <div class="container" id="genreContainer"></div>
        <div class="modal" id="movieModal">
            <div class="modal-content">
                <button class="modal-close" id="closeModal" aria-label="Close modal">✖</button>
                <div class="modal-poster" id="modalPoster">Poster</div>
                <h2 id="modalTitle"></h2>
                <p><strong>IMDb ID:</strong> <span id="modalImdbId"></span></p>
                <p><strong>Genres:</strong> <span id="modalGenres"></span></p>
                <p><strong>Release Year:</strong> <span id="modalReleaseYear"></span></p>
                <p><strong>Rating:</strong> <span id="modalRating"></span></p>
                <p><strong>Director:</strong> <span id="modalDirector"></span></p>
                <p><strong>Cast:</strong> <span id="modalCast"></span></p>
                <p><strong>Runtime:</strong> <span id="modalRuntime"></span></p>
                <p><strong>Tagline:</strong> <span id="modalTagline"></span></p>
                <p><strong>Keywords:</strong> <span id="modalKeywords"></span></p>
                <p><strong>Production Companies:</strong> <span id="modalProduction"></span></p>
                <p><strong>Overview:</strong> <span id="modalOverview"></span></p>
                <p><strong>Homepage:</strong> <a href="#" id="modalHomepage" target="_blank"></a></p>
            </div>
        </div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const hamburger = document.querySelector('.hamburger');
            const navContainer = document.querySelector('.containerr');
            if (hamburger && navContainer) {
                hamburger.addEventListener('click', () => {
                    navContainer.classList.toggle('active');
                });
            }

            let movies = [];

            async function loadMovies() {
                try {
                    const [response1, response2] = await Promise.all([
                        fetch('/movies2.json'),
                        fetch('/auth/data/movies.json')
                    ]);

                    if (!response1.ok || !response2.ok) {
                        throw new Error('Failed to fetch one or both JSON files');
                    }

                    const movies1 = await response1.json();
                    const movies2 = await response2.json();
                    movies = [...movies1, ...movies2];

                    const genreMap = {};
                    movies.forEach((movie) => {
                        if (movie.genres) {
                            movie.genres.split("|").forEach((genre) => {
                                if (!genreMap[genre]) genreMap[genre] = [];
                                genreMap[genre].push(movie);
                            });
                        }
                    });

                    const container = document.getElementById("genreContainer");

                    Object.entries(genreMap).forEach(([genre, movies]) => {
                        const section = document.createElement("div");
                        section.className = "genre-section";

                        const header = document.createElement("div");
                        header.className = "genre-header";
                        const h2 = document.createElement("h2");
                        h2.textContent = genre;
                        const toggleBtn = document.createElement("button");
                        toggleBtn.className = "toggle-btn";
                        toggleBtn.textContent = "More";

                        let showing = 5;
                        const row = document.createElement("div");
                        row.className = "movie-row";

                        function renderCards() {
                            row.innerHTML = "";
                            movies.slice(0, showing).forEach((movie) => {
                                const card = document.createElement("div");
                                card.className = "movie-card";
                                const stars = Math.round((movie.vote_average || 0) / 2);
                                let starHtml = "";
                                for (let i = 1; i <= 5; i++) {
                                    starHtml += `<span class="stars">${i <= stars ? "★" : "☆"}</span>`;
                                }
                                card.innerHTML = `
                                    <div class="movie-placeholder">${movie.original_title || 'Untitled'}</div>
                                    <div class="movie-content">
                                        <h3 class="movie-title">${movie.original_title || 'Untitled'}</h3>
                                        <p class="movie-meta"><strong>Year:</strong> ${movie.release_year || 'N/A'}</p>
                                        <p class="movie-meta"><strong>Rating:</strong> ${movie.vote_average || 'N/A'} ${starHtml}</p>
                                        <p class="movie-meta">${(movie.overview || '').substring(0, 80) || 'N/A'}...</p>
                                    </div>`;
                                card.addEventListener("click", () => showModal(movie));
                                row.appendChild(card);
                            });
                        }

                        toggleBtn.addEventListener("click", () => {
                            if (showing === 5) {
                                showing = movies.length;
                                toggleBtn.textContent = "Less";
                            } else {
                                showing = 5;
                                toggleBtn.textContent = "More";
                            }
                            renderCards();
                        });

                        renderCards();
                        header.appendChild(h2);
                        header.appendChild(toggleBtn);
                        section.appendChild(header);
                        section.appendChild(row);
                        container.appendChild(section);
                    });
                } catch (error) {
                    console.error('Error loading movies:', error);
                    document.getElementById("genreContainer").innerHTML = '<p>Error loading movies. Please try again later.</p>';
                }
            }

            function showModal(movie) {
                document.getElementById("modalPoster").textContent = movie.original_title || "Poster";
                document.getElementById("modalTitle").textContent = movie.original_title || "N/A";
                document.getElementById("modalImdbId").textContent = movie.imdb_id || "N/A";
                document.getElementById("modalGenres").textContent = movie.genres || "N/A";
                document.getElementById("modalReleaseYear").textContent = movie.release_year || "N/A";
                document.getElementById("modalRating").textContent = movie.vote_average || "N/A";
                document.getElementById("modalDirector").textContent = movie.director || "N/A";
                document.getElementById("modalCast").textContent = movie.cast || "N/A";
                document.getElementById("modalRuntime").textContent = movie.runtime || "N/A";
                document.getElementById("modalTagline").textContent = movie.tagline || "N/A";
                document.getElementById("modalKeywords").textContent = movie.keywords || "N/A";
                document.getElementById("modalProduction").textContent = movie.production_companies || "N/A";
                document.getElementById("modalOverview").textContent = movie.overview || "N/A";
                const homepage = document.getElementById("modalHomepage");
                homepage.href = movie.homepage || "#";
                homepage.textContent = movie.homepage || "N/A";
                document.getElementById("movieModal").style.display = "flex";
            }

            document.getElementById("closeModal").addEventListener("click", () => {
                document.getElementById("movieModal").style.display = "none";
            });

            window.addEventListener("click", (event) => {
                if (event.target === document.getElementById("movieModal")) {
                    document.getElementById("movieModal").style.display = "none";
                }
            });

            loadMovies();
        });
    </script>
</body>
</html>